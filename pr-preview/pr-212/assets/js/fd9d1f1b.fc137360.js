"use strict";(self.webpackChunkrts_docs_dev=self.webpackChunkrts_docs_dev||[]).push([["8819"],{23330:function(e,n,s){s.r(n),s.d(n,{metadata:()=>t,default:()=>u,frontMatter:()=>r,contentTitle:()=>a,toc:()=>l,assets:()=>c});var t=JSON.parse('{"id":"hpc/submitting_jobs/slurm_submitting_jobs","title":"Slurm: Submitting Jobs","description":"If you are new to using HPC resources and would like to learn about the principles of using the SLURM scheduler for submitting batch jobs, please refer to cthis section](../13tutorialintrohpc/04scheduler_fundamentals.mdx).","source":"@site/docs/hpc/05_submitting_jobs/01_slurm_submitting_jobs.md","sourceDirName":"hpc/05_submitting_jobs","slug":"/hpc/submitting_jobs/slurm_submitting_jobs","permalink":"/pr-preview/pr-212/docs/hpc/submitting_jobs/slurm_submitting_jobs","draft":false,"unlisted":false,"editUrl":"https://github.com/NYU-RTS/rts-docs/blob/main/docs/hpc/05_submitting_jobs/01_slurm_submitting_jobs.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{},"sidebar":"hpcSidebar","previous":{"title":"Working with Datasets","permalink":"/pr-preview/pr-212/docs/hpc/datasets/working_with_datasets"},"next":{"title":"Slurm: Command reference","permalink":"/pr-preview/pr-212/docs/hpc/submitting_jobs/slurm_main_commands"}}'),o=s(47259),i=s(55511);let r={},a="Slurm: Submitting Jobs",c={},l=[{value:"Start an Interactive Job",id:"start-an-interactive-job",level:3},{value:"Request Resources",id:"request-resources",level:3},{value:"Interactive Job Options",id:"interactive-job-options",level:3},{value:"Interactive Bash Job Examples",id:"interactive-bash-job-examples",level:3},{value:"R interactive job",id:"r-interactive-job",level:3}];function d(e){let n={a:"a",admonition:"admonition",code:"code",h1:"h1",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.header,{children:(0,o.jsx)(n.h1,{id:"slurm-submitting-jobs",children:"Slurm: Submitting Jobs"})}),"\n",(0,o.jsx)(n.admonition,{title:"[Beginner tutorial available]",type:"tip",children:(0,o.jsxs)(n.p,{children:["If you are new to using HPC resources and would like to learn about the principles of using the ",(0,o.jsx)(n.code,{children:"SLURM"})," scheduler for submitting batch jobs, please refer to cthis section](../13_tutorial_intro_hpc/04_scheduler_fundamentals.mdx)."]})}),"\n",(0,o.jsxs)(n.admonition,{type:"tip",children:[(0,o.jsxs)(n.p,{children:["Instead of running interactive jobs on Login nodes, users can run interactive jobs on the HPC Compute nodes using SLURM's ",(0,o.jsx)(n.code,{children:"srun"})," utility. Running interactive jobs on compute nodes does not impact many users and in addition provides access to resources that are not available on the login nodes, such as interactive access to GPUs, high memory, exclusive access to all the resources of a compute node, etc."]}),(0,o.jsx)(n.admonition,{type:"note",children:(0,o.jsx)(n.p,{children:"There is no partition on the HPC cluster that has been reserved for Interactive jobs."})})]}),"\n",(0,o.jsx)(n.h3,{id:"start-an-interactive-job",children:"Start an Interactive Job"}),"\n",(0,o.jsxs)(n.p,{children:["When you start an interactive batch job the command prompt is not immediately returned. Instead, you wait until the resource is available when the prompt is returned and you are on a compute node and in a batch job - much like the process of logging in to a host with ssh. ",(0,o.jsx)(n.strong,{children:"To end the session, type 'exit'"}),", again just like the process of logging in and out with ssh."]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-sh",children:"[NetID@log-1 ~]$ srun --pty /bin/bash\nsrun: job 58699789 queued and waiting for resources\nsrun: job 58699789 has been allocated resources\n[NetID@cm034 ~]$ hostname\ncm034.hpc.nyu.edu\n"})}),"\n",(0,o.jsx)(n.p,{children:"To use any GUI-based program within the interactive batch session you will need to extend X forwarding with the --x11 option. This of course still relies on you having X forwarding at your login session.  To test if you have X forwarding running, you can try running the gnuplot test as shown:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-sh",children:"[NetID@log-1 ~]$ module load gnuplot/gcc/5.4.1\n[NetID@log-1 ~]$ gnuplot\ngnuplot> test\n"})}),"\n",(0,o.jsxs)(n.p,{children:["If a window opens on your display with a gnuplot test window, you know that Xforwarding is working.  Please see the ",(0,o.jsx)(n.a,{href:"/pr-preview/pr-212/docs/hpc/connecting_to_hpc/x11_forwarding",children:"X11 Forwarding"})," section for details."]}),"\n",(0,o.jsx)(n.h3,{id:"request-resources",children:"Request Resources"}),"\n",(0,o.jsx)(n.p,{children:"You can request resources for an interactive batch session just as you would for any other job, for example to request 4 processors with 4GB memory for 2 hours."}),"\n",(0,o.jsx)(n.p,{children:"If you do not request resources you will get the default settings. If after some directory navigation in your interactive session, you can jump back to the directory you submitted from with:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-sh",children:"[NetID@cm034 ~]$ cd $SLURM_SUBMIT_DIR\n"})}),"\n",(0,o.jsx)(n.h3,{id:"interactive-job-options",children:"Interactive Job Options"}),"\n",(0,o.jsxs)(n.p,{children:["(Don't just submit the job, but also wait for it to start and connect ",(0,o.jsx)(n.code,{children:"stdout"}),", ",(0,o.jsx)(n.code,{children:"stderr"})," and ",(0,o.jsx)(n.code,{children:"stdin"})," to the current terminal)"]}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.code,{children:"-nnum"})}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Specify the number of tasks to run, eg. -n4. Default is one CPU core per task"}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.code,{children:"-ttime"})}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["Request job running duration, eg. ",(0,o.jsx)(n.code,{children:"-t1:30:00"})]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.code,{children:"--mem=MB"})}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["Specify the real memory required per node in MegaBytes, eg. ",(0,o.jsx)(n.code,{children:"--mem=4000"})]}),"\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.code,{children:"--pty"})}),"\n",(0,o.jsxs)(n.li,{children:["Execute the first task in pseudo terminal mode, eg. ",(0,o.jsx)(n.code,{children:"--pty /bin/bash"}),", to start a bash command shell"]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.code,{children:"--gres=gpu:N"})}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["To request ",(0,o.jsx)(n.code,{children:"N"})," number of GPUs"]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.code,{children:"--x11"})}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Enable X forwarding, so programs using a GUI can be used during the session (provided you have X forwarding to your workstation set up)"}),"\n",(0,o.jsxs)(n.li,{children:["To leave an interactive batch session, type ",(0,o.jsx)(n.code,{children:"exit"})," at the command prompt"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:"Certain tasks need user interaction - such as debugging and some GUI-based applications. However the HPC clusters rely on batch job scheduling to efficiently allocate resources. Interactive batch jobs allow these apparently conflicting requirements to be met."}),"\n",(0,o.jsx)(n.h3,{id:"interactive-bash-job-examples",children:"Interactive Bash Job Examples"}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"Example (Without x11 forwarding)"})}),"\n",(0,o.jsxs)(n.p,{children:["Through ",(0,o.jsx)(n.code,{children:"srun"})," SLURM provides rich command line options for users to request resources from the cluster, to allow interactive jobs. Please see some examples and short accompanying explanations in the code block below, which should cover many of the use cases."]}),"\n",(0,o.jsxs)(n.p,{children:["In the srun examples below, through ",(0,o.jsx)(n.code,{children:"--pty /bin/bash"})," we request to start bash command shell session in pseudo terminal by default the resource allocated is single CPU core and 2GB memory for 1 hour:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-sh",children:"[NetID@log-1 ~]$ srun --pty /bin/bash\n"})}),"\n",(0,o.jsx)(n.p,{children:"To request 4 CPU cores, 4 GB memory, and 2 hour running duration:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-sh",children:"[NetID@log-1 ~]$ srun -c4 -t2:00:00 --mem=4000 --pty /bin/bash\n"})}),"\n",(0,o.jsx)(n.p,{children:"To request one GPU card, 3 GB memory, and 1.5 hour running duration:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-sh",children:"[NetID@log-1 ~]$ srun -t1:30:00 --mem=3000 --gres=gpu:1 --pty /bin/bash\n"})}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"Example (x11 forwarding)"})}),"\n",(0,o.jsx)(n.p,{children:'In srun there is an option "\u2013x11", which enables X forwarding, so programs using a GUI can be used during an interactive session (provided you have X forwarding to your workstation set up).'}),"\n",(0,o.jsx)(n.p,{children:"To request computing resources, and export x11 display on allocated node(s)"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-sh",children:"[NetID@log-1 ~]$ srun --x11 -c4 -t2:00:00 --mem=4000 --pty /bin/bash\n[NetID@cm034 ~]$ module load gnuplot/gcc/5.4.1\n[NetID@cm034 ~]$ gnuplot\ngnuplot> test\n"})}),"\n",(0,o.jsx)(n.p,{children:"To request GPU card etc, and export x11 display:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-sh",children:"[NetID@log-1 ~]$ srun --x11 -t1:30:00 --mem=3000 --gres=gpu:1 --pty /bin/bash\n"})}),"\n",(0,o.jsx)(n.h3,{id:"r-interactive-job",children:"R interactive job"}),"\n",(0,o.jsx)(n.p,{children:"The following example shows how to work with Interactive R session on a compute node:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-sh",children:"[NetID@log-1 ~]$ srun -c 1 --pty /bin/bash\n[NetID@cm034 ~]$ module purge\n[NetID@cm034 ~]$ module list\n\nNo modules loaded\n[NetID@cm034 ~]$ module load r/gcc/4.4.0\n[NetID@cm034 ~]$ module list\n\nCurrently Loaded Modules:\n  1) r/intel/4.4.0\n\n[NetID@cm034 ~]$ R\nR version 4.4.0 (2024-04-24) -- \"Puppy Cup\"\nCopyright (C) 2024 The R Foundation for Statistical Computing\nPlatform: x86_64-pc-linux-gnu\n\nR is free software and comes with ABSOLUTELY NO WARRANTY.\nYou are welcome to redistribute it under certain conditions.\nType 'license()' or 'licence()' for distribution details.\n\nR is a collaborative project with many contributors.\nType 'contributors()' for more information and\n'citation()' on how to cite R or R packages in publications.\n\nType 'demo()' for some demos, 'help()' for on-line help, or\n'help.start()' for an HTML browser interface to help.\nType 'q()' to quit R.\n> 5 + 10\n[1] 15\n> 6 ** 2\n[1] 36\n> tan(45)\n[1] 1.619775\n>\n> q()\nSave workspace image? [y/n/c]: n\n[NetID@cm034 ~]$ exit\nexit\n[NetID@log-1 ~]$\n"})})]})}function u(e={}){let{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}},55511:function(e,n,s){s.d(n,{R:()=>r,x:()=>a});var t=s(96363);let o={},i=t.createContext(o);function r(e){let n=t.useContext(i);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:r(e.components),t.createElement(i.Provider,{value:n},e.children)}}}]);